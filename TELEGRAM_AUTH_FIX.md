# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å Telegram –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π

## –ü—Ä–æ–±–ª–µ–º–∞
–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ Telegram –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –º–æ–≥ –≤–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É. –ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –≤–æ–π—Ç–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏–ª–æ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–±—Ä–∞—Ç–Ω–æ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏.

## –ü—Ä–∏—á–∏–Ω–∞
–í –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (`AuthContext.tsx`) —Ñ—É–Ω–∫—Ü–∏—è `login` —Ç–æ–ª—å–∫–æ —Å–æ—Ö—Ä–∞–Ω—è–ª–∞ —Ç–æ–∫–µ–Ω—ã –≤ localStorage, –Ω–æ –Ω–µ –∑–∞–≥—Ä—É–∂–∞–ª–∞ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –ò–∑-–∑–∞ —ç—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏–µ `user` –æ—Å—Ç–∞–≤–∞–ª–æ—Å—å `null`, –∏ `isAuthenticated` –≤–æ–∑–≤—Ä–∞—â–∞–ª `false`, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏–ª–æ –∫ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—é –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏.

## –†–µ—à–µ–Ω–∏–µ
–û–±–Ω–æ–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `login` –≤ `AuthContext.tsx`:
- –¢–µ–ø–µ—Ä—å –ø–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–æ–≤ —Ñ—É–Ω–∫—Ü–∏—è –∑–∞–≥—Ä—É–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —á–µ—Ä–µ–∑ `/auth/me/`
- –§—É–Ω–∫—Ü–∏—è —Å—Ç–∞–ª–∞ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π (`async`)
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ - –µ—Å–ª–∏ –∑–∞–≥—Ä—É–∑–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ —É–¥–∞–ª–∞—Å—å, —Ç–æ–∫–µ–Ω—ã —É–¥–∞–ª—è—é—Ç—Å—è

## –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### 1. `/frontend/src/contexts/AuthContext.tsx`
- –ò–∑–º–µ–Ω–µ–Ω —Ç–∏–ø `login` —Å `void` –Ω–∞ `Promise<void>`
- –§—É–Ω–∫—Ü–∏—è `login` —Ç–µ–ø–µ—Ä—å –∑–∞–≥—Ä—É–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–æ–≤

### 2. `/frontend/src/pages/AuthPage.tsx`
- –î–æ–±–∞–≤–ª–µ–Ω `await` –ø–µ—Ä–µ–¥ –≤—ã–∑–æ–≤–æ–º `login()`

## –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞
1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ backend:
```bash
cd backend
source venv/bin/activate
python manage.py runserver
```

2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ frontend:
```bash
cd frontend
npm run dev
```

3. –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:5173/auth

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
–ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –µ—Å—Ç—å –∫–Ω–æ–ø–∫–∞ "üîß –†–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏":
1. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫—É
2. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ:
   - Telegram ID: –ª—é–±–æ–µ —á–∏—Å–ª–æ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 123456789)
   - –ò–º—è: –≤–∞—à–µ —Ç–µ—Å—Ç–æ–≤–æ–µ –∏–º—è
   - Username: –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
3. –ù–∞–∂–º–∏—Ç–µ "üöÄ –í–æ–π—Ç–∏"

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å –Ω–∞—Å—Ç–æ—è—â–∏–º Telegram Login Widget
1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –≤–∞—Å –Ω–∞—Å—Ç—Ä–æ–µ–Ω Telegram –±–æ—Ç (@cardloginbot)
2. –ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –±—É–¥–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è Telegram Login Widget
3. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫—É "Login via Telegram"
4. –ê–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ—Å—å —á–µ—Ä–µ–∑ Telegram

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è API

### –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞
API –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ `http://localhost:8000/api`

### Production
API –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ `https://cardholder.onrender.com/api`

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `frontend/.env`:
```env
VITE_API_URL=http://localhost:8000/api
```

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã
1. –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12)
2. –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤—ã —É–≤–∏–¥–∏—Ç–µ:
   ```
   API_BASE_URL: http://localhost:8000/api (–∏–ª–∏ production URL)
   VITE_API_URL: undefined (–∏–ª–∏ –≤–∞—à–µ –∑–Ω–∞—á–µ–Ω–∏–µ)
   PROD: false (–∏–ª–∏ true)
   ```
3. –ü—Ä–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:
   - –î–æ–ª–∂–µ–Ω –ø–æ—è–≤–∏—Ç—å—Å—è –∑–∞–ø—Ä–æ—Å –∫ `/api/auth/telegram/`
   - –ó–∞—Ç–µ–º –∑–∞–ø—Ä–æ—Å –∫ `/api/auth/me/`
   - –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ `/dashboard`

## Backend endpoints
- `POST /api/auth/telegram/` - –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ Telegram
- `GET /api/auth/me/` - –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `POST /api/auth/subscription/` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ Telegram –∫–∞–Ω–∞–ª

## Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: CORS –æ—à–∏–±–∫–∏
**–†–µ—à–µ–Ω–∏–µ**: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ `backend/config/settings.py` –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã `CORS_ALLOWED_ORIGINS`

### –ü—Ä–æ–±–ª–µ–º–∞: 401 Unauthorized –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ `/auth/me/`
**–†–µ—à–µ–Ω–∏–µ**: 
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ç–æ–∫–µ–Ω —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ localStorage
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ interceptor –¥–æ–±–∞–≤–ª—è–µ—Ç —Ç–æ–∫–µ–Ω –≤ –∑–∞–≥–æ–ª–æ–≤–∫–∏

### –ü—Ä–æ–±–ª–µ–º–∞: –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞
**–†–µ—à–µ–Ω–∏–µ**:
```bash
cd backend
python manage.py migrate
```

### –ü—Ä–æ–±–ª–µ–º–∞: Backend –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
**–†–µ—à–µ–Ω–∏–µ**:
```bash
cd backend
source venv/bin/activate
pip install -r requirements.txt
python manage.py migrate
python manage.py runserver
```

