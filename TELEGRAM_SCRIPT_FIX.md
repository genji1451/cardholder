# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –∑–∞–≥—Ä—É–∑–∫–∏ Telegram —Å–∫—Ä–∏–ø—Ç–∞

## üêõ –ü—Ä–æ–±–ª–µ–º–∞

–ù–∞ —Å–∫—Ä–∏–Ω—à–æ—Ç–µ –≤–∏–¥–Ω–æ:
```
‚ùå Failed to load Telegram script
GET https://telegram.org/js/telegram-widget.js?22 
net::ERR_CONNECTION_TIMED_OUT
```

**–ü—Ä–∏—á–∏–Ω–∞:** –°–∫—Ä–∏–ø—Ç —Å `telegram.org` –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏–∑-–∑–∞:
- –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∏ telegram.org –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Ä–µ–≥–∏–æ–Ω–∞—Ö
- –ü—Ä–æ–±–ª–µ–º—ã —Å Content Security Policy
- –°–µ—Ç–µ–≤—ã—Ö –ø—Ä–æ–±–ª–µ–º

## ‚úÖ –ß—Ç–æ —è –∏—Å–ø—Ä–∞–≤–∏–ª

### 1. –û–±–Ω–æ–≤–∏–ª `vercel.json`
–î–æ–±–∞–≤–∏–ª –∑–∞–≥–æ–ª–æ–≤–∫–∏ Content Security Policy –¥–ª—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ —Å–∫—Ä–∏–ø—Ç–æ–≤ —Å telegram.org:
```json
"headers": [
  {
    "source": "/(.*)",
    "headers": [
      {
        "key": "Content-Security-Policy",
        "value": "...—Ä–∞–∑—Ä–µ—à–∞–µ—Ç telegram.org..."
      }
    ]
  }
]
```

### 2. –û–±–Ω–æ–≤–∏–ª `TelegramAuth.tsx`
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ **–ª–æ–≥–∏–∫–∞ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫** –∑–∞–≥—Ä—É–∑–∫–∏ —Å–∫—Ä–∏–ø—Ç–∞
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –∞—Ç—Ä–∏–±—É—Ç `crossOrigin="anonymous"`
- ‚úÖ –ë–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ –ü–æ–ª–µ–∑–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ —Å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### 3. –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
–¢–µ–ø–µ—Ä—å –µ—Å–ª–∏ —Å–∫—Ä–∏–ø—Ç –Ω–µ –∑–∞–≥—Ä—É–∑–∏—Ç—Å—è:
- –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ø—Ä–æ–±—É–µ—Ç –∑–∞–≥—Ä—É–∑–∏—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω–æ
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–≤–∏–¥–∏—Ç –ø–æ–Ω—è—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å —Ä–µ—à–µ–Ω–∏–µ–º
- –ë—É–¥–µ—Ç –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å "–†–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏"

---

## üöÄ –ß—Ç–æ –¥–µ–ª–∞—Ç—å —Å–µ–π—á–∞—Å

### –®–∞–≥ 1: –ó–∞–∫–æ–º–º–∏—Ç—å—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

```bash
git add vercel.json frontend/src/components/TelegramAuth.tsx
git commit -m "Fix: Telegram widget script loading with retry logic and CSP headers"
git push origin main
```

### –®–∞–≥ 2: –î–æ–∂–¥–∏—Ç–µ—Å—å –¥–µ–ø–ª–æ—è –Ω–∞ Vercel

- –û–±—ã—á–Ω–æ 1-2 –º–∏–Ω—É—Ç—ã
- –°–ª–µ–¥–∏—Ç–µ –∑–∞ —Å—Ç–∞—Ç—É—Å–æ–º –≤ Vercel Dashboard

### –®–∞–≥ 3: –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ

1. –û—Ç–∫—Ä–æ–π—Ç–µ –≤–∞—à URL –Ω–∞ Vercel
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
3. –ù–∞–∂–º–∏—Ç–µ "üîÑ –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ Telegram"

**–ß—Ç–æ –≤—ã —É–≤–∏–¥–∏—Ç–µ:**

**–í–∞—Ä–∏–∞–Ω—Ç –ê: –°–∫—Ä–∏–ø—Ç –∑–∞–≥—Ä—É–∑–∏–ª—Å—è** ‚úÖ
```
üîß Debug: –°–∫—Ä–∏–ø—Ç –∑–∞–≥—Ä—É–∂–µ–Ω
(–ó–∞—Ç–µ–º —á–µ—Ä–µ–∑ 1.5 —Å–µ–∫)
üîß Debug: –í–∏–¥–∂–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω ‚úÖ
```
–ò –ø–æ—è–≤–∏—Ç—Å—è –∫–Ω–æ–ø–∫–∞ "Log in with Telegram"

**–í–∞—Ä–∏–∞–Ω—Ç –ë: –°–∫—Ä–∏–ø—Ç –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª—Å—è –ø–æ—Å–ª–µ 2 –ø–æ–ø—ã—Ç–æ–∫** ‚ùå
```
üîß Debug: –ü–æ–≤—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏... (–ø–æ–ø—ã—Ç–∫–∞ 2)
(–ó–∞—Ç–µ–º)
üîß Debug: ‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–∫—Ä–∏–ø—Ç Telegram

‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å Telegram –≤–∏–¥–∂–µ—Ç. –í–æ–∑–º–æ–∂–Ω–æ telegram.org 
   –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –∏–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã —Å —Å–µ—Ç—å—é.

üí° –†–µ—à–µ–Ω–∏–µ: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ "–†–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏" –Ω–∏–∂–µ. 
   –û–Ω –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–µ–Ω –∏ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ telegram.org
```

---

## üîç –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ –∫–æ–Ω—Å–æ–ª–∏

–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –æ—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å (F12):

**–ï—Å–ª–∏ —Å–∫—Ä–∏–ø—Ç –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è:**
```
üîµ TelegramAuth: Component mounted
üîµ Bot name: cardloginbot
üîç Container found: true
‚úÖ Script appended to container
‚úÖ Telegram script loaded (attempt 1)
üîç Checking for iframe: <iframe...>
‚úÖ Iframe found
Iframe src: https://oauth.telegram.org/embed/...
```

**–ï—Å–ª–∏ —Å–∫—Ä–∏–ø—Ç –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è:**
```
üîµ TelegramAuth: Component mounted
üîµ Bot name: cardloginbot
üîç Container found: true
‚úÖ Script appended to container
‚ùå Failed to load Telegram script (attempt 1) Event {...}
Script URL: https://telegram.org/js/telegram-widget.js?22
üîÑ Retrying with different URL...
(–ø–æ–¥–æ–∂–¥–∞—Ç—å 2 —Å–µ–∫—É–Ω–¥—ã)
‚ùå Failed to load Telegram script (attempt 2) Event {...}
Script URL: https://telegram.org/js/telegram-widget.js?...
```

---

## üí° –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ

### –ï—Å–ª–∏ telegram.org –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω

**–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:**

–ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤–Ω–∏–∑—É –µ—Å—Ç—å –∫–Ω–æ–ø–∫–∞:
```
üîß –†–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ù–µ —Ç—Ä–µ–±—É–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ telegram.org
- ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–µ–Ω
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –≤–µ–∑–¥–µ (–ª–æ–∫–∞–ª—å–Ω–æ –∏ –Ω–∞ production)
- ‚úÖ –ù–µ —Ç—Ä–µ–±—É–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–æ—Ç–∞
- ‚úÖ –¢–∞–∫–∞—è –∂–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

**–ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
1. –ù–∞–∂–º–∏—Ç–µ "üîß –†–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏"
2. –í–≤–µ–¥–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ (–ª—é–±—ã–µ)
3. –í–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É
4. –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç!

### –ò–ª–∏ —Å–¥–µ–ª–∞–π—Ç–µ —Ä–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

–ï—Å–ª–∏ Telegram Widget –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞—Ç—å, –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —Ä–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –æ—Å–Ω–æ–≤–Ω—ã–º.

–û—Ç–∫—Ä–æ–π—Ç–µ `frontend/src/pages/AuthPage.tsx` –∏ –∏–∑–º–µ–Ω–∏—Ç–µ:

```typescript
// –ë—ã–ª–æ:
const [useDevMode, setUseDevMode] = useState(false);

// –°—Ç–∞–Ω–µ—Ç:
const [useDevMode, setUseDevMode] = useState(true);
```

–¢–µ–ø–µ—Ä—å –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å—Ä–∞–∑—É –±—É–¥–µ—Ç —Ä–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏.

---

## üåê –ü–æ—á–µ–º—É telegram.org –º–æ–∂–µ—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞—Ç—å

1. **–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–º** - –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã –±–ª–æ–∫–∏—Ä—É—é—Ç telegram.org
2. **–ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–∞—è —Å–µ—Ç—å** - –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ —Ä–∞–±–æ—Ç–µ/–≤ –æ—Ñ–∏—Å–µ
3. **VPN/–ü—Ä–æ–∫—Å–∏** - –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ VPN –±–ª–æ–∫–∏—Ä—É—é—Ç telegram.org
4. **–†–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è** - –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å—Ç—Ä–∞–Ω–∞—Ö

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ - –æ–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–µ–∑–¥–µ! üöÄ

---

## ‚úÖ Checklist

- [x] –û–±–Ω–æ–≤–ª–µ–Ω `vercel.json` —Å CSP –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏
- [x] –û–±–Ω–æ–≤–ª–µ–Ω `TelegramAuth.tsx` —Å retry –ª–æ–≥–∏–∫–æ–π
- [x] –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ–∑–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
- [ ] –ó–∞–∫–æ–º–º–∏—á–µ–Ω—ã –∏–∑–º–µ–Ω–µ–Ω–∏—è
- [ ] –ó–∞–¥–µ–ø–ª–æ–µ–Ω–æ –Ω–∞ Vercel
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ
- [ ] –ï—Å–ª–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ä–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

---

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–µ—à–µ–Ω–∏–π

| –ú–µ—Ç–æ–¥ | –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å | –ù–∞—Å—Ç—Ä–æ–π–∫–∞ | –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è |
|-------|------------|-----------|--------------|
| **Telegram Login Widget** | –ó–∞–≤–∏—Å–∏—Ç –æ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ telegram.org | –¢—Ä–µ–±—É–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ BotFather | ‚ö†Ô∏è –ï—Å–ª–∏ telegram.org –¥–æ—Å—Ç—É–ø–µ–Ω |
| **–†–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏** | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –≤–µ–∑–¥–µ | ‚ùå –ù–µ —Ç—Ä–µ–±—É–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ | ‚úÖ **–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø** |

---

**–î–∞—Ç–∞:** 2025-10-11  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –¥–µ–ø–ª–æ—é

## üéØ –ö—Ä–∞—Ç–∫–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è

```bash
# 1. –ö–æ–º–º–∏—Ç
git add vercel.json frontend/src/components/TelegramAuth.tsx
git commit -m "Fix: Telegram script loading with retry and CSP"
git push

# 2. –ü–æ–¥–æ–∂–¥–∞—Ç—å –¥–µ–ø–ª–æ–π –Ω–∞ Vercel (1-2 –º–∏–Ω)

# 3. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ –≤–∞—à–µ–º URL

# 4. –ï—Å–ª–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏!
```

